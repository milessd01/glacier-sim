<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Glacier Mission Control</title>
    <link rel="stylesheet" href="/src/styles.css" />
  </head>
  <body>
    <main class="app">
      <header class="header">
        <div>
          <p class="eyebrow">Glacier Mission Control</p>
          <h1>Mendenhall Glacier Operations</h1>
          <p class="subtitle">Live atmospheric inputs and mass-balance diagnostics.</p>
        </div>
        <div class="header-actions">
          <button id="glacier-info" class="btn btn-secondary">Mendenhall Glacier Info</button>
          <button id="refresh-weather" class="btn btn-primary">Refresh Data</button>
          <span id="data-status" class="status-pill live">Live data</span>
        </div>
      </header>

      <section class="grid">
        <article class="card">
          <h2>Current Conditions</h2>
          <div class="metric-row">
            <span>Temperature</span>
            <strong><span id="temperature">--</span>Â°C</strong>
          </div>
          <div class="metric-row">
            <span>Wind Speed</span>
            <strong><span id="wind-speed">--</span> km/h</strong>
          </div>
          <div class="metric-row">
            <span>Precipitation</span>
            <strong><span id="precipitation">--</span> mm</strong>
          </div>
          <div class="metric-row">
            <span>Humidity</span>
            <strong><span id="humidity">--</span>%</strong>
          </div>
          <div class="metric-row">
            <span>Pressure</span>
            <strong><span id="pressure">--</span> hPa</strong>
          </div>
          <p class="timestamp">Updated: <span id="timestamp">--</span></p>
        </article>

        <article class="card">
          <h2>Today's Prediction</h2>
          <div class="metric-row">
            <span>Daily Mass Change</span>
            <strong><span id="daily-change">--</span></strong>
          </div>
          <div class="metric-row">
            <span>Glacier Health Index</span>
            <strong><span id="health-index">--</span></strong>
          </div>
          <div class="metric-row">
            <span>Glacier State</span>
            <strong id="glacier-state" class="badge stable">Stable</strong>
          </div>
          <div class="metric-row">
            <span>Model Confidence</span>
            <strong id="confidence-badge" class="confidence-badge medium">Medium</strong>
          </div>
          <p id="confidence-why" class="hint">Evaluating data freshness and variability.</p>
          <div id="alert-badges" class="alert-badges"></div>
          <p class="hint">Snowfall only counts when temperature is &lt;= 1C.</p>
        </article>

        <article class="card">
          <h2>Trend</h2>
          <div class="metric-row">
            <span>7-Day Rolling Trend</span>
            <strong><span id="seven-day-trend">--</span></strong>
          </div>
          <p id="simulation-source" class="hint">Simulation source: Observed</p>
          <div class="button-row">
            <button class="btn btn-secondary" data-simulate="1">Simulate 1 Day</button>
            <button class="btn btn-secondary" data-simulate="7">Simulate 7 Days</button>
            <button class="btn btn-secondary" data-simulate="30">Simulate 30 Days</button>
          </div>
        </article>

        <article class="card">
          <h2>Scenario Simulations</h2>
          <p class="hint">Run alternate climate paths, then simulate days.</p>
          <div class="button-row">
            <button class="btn btn-secondary scenario-btn" data-scenario="ice-age">Ice Age</button>
            <button class="btn btn-secondary scenario-btn" data-scenario="warming">More Warming</button>
          </div>
          <p class="hint">Each scenario runs a 7-day simulation.</p>
          <p id="scenario-status" class="hint">Scenario: Live baseline</p>
        </article>

        <article class="card chart-card">
          <h2>Glacier Health Index (<span id="chart-window-health">30</span> Days)</h2>
          <canvas id="chart-health" height="160"></canvas>
        </article>

        <article class="card chart-card">
          <h2>Daily Mass Change (<span id="chart-window-mass">30</span> Days)</h2>
          <canvas id="chart-mass" height="160"></canvas>
        </article>

        <article class="card">
          <h2>Time-to-Loss Projection</h2>
          <p class="metric-row">
            <span>Collapse Threshold</span>
            <strong>Health Index 40</strong>
          </p>
          <p id="time-to-loss-value" class="projection-value">--</p>
          <p id="time-to-loss-meta" class="hint">Based on 7-day rolling trend.</p>
          <p id="time-to-loss-source" class="hint">Source: --</p>
        </article>

        <article class="card summary-card">
          <h2>Daily Summary</h2>
          <p id="daily-summary">
            Loading the latest mission brief for Mendenhall Glacier.
          </p>
        </article>
      </section>
    </main>

    <section id="info-panel" class="info-panel hidden">
      <div class="info-card">
        <div class="info-header">
          <div>
            <p class="eyebrow">Field Briefing</p>
            <h2>Mendenhall Glacier</h2>
            <p class="subtitle">History, context, and fast facts.</p>
          </div>
          <button id="info-home" class="btn btn-primary">Home</button>
        </div>
        <div class="info-grid">
          <article class="info-block">
            <h3>Origin Story</h3>
            <p>
              Mendenhall Glacier (also known by Tlingit names, and once called
              "Auk Glacier") is a 13 to 13.6 mile long valley glacier in the
              Mendenhall Valley near Juneau, Alaska. It flows out of the Juneau
              Icefield, a roughly 1,500 square mile icefield that feeds dozens of
              glaciers, and terminates at Mendenhall Lake inside the federally
              managed Mendenhall Glacier Recreation Area within Tongass National
              Forest.
            </p>
            <p>
              The modern name honors Thomas Corwin Mendenhall (U.S. Coast and
              Geodetic Survey). John Muir referred to it as "Auk Glacier" in the
              late 1800s, reflecting the Auke/Aak'w area's Indigenous ties.
            </p>
          </article>
          <article class="info-block">
            <h3>Timeline Highlights</h3>
            <ul>
              <li>
                Little Ice Age peak to modern retreat: the glacier's maximum advance
                occurred around the mid-1700s; retreat begins after that period as
                climate conditions shift.
              </li>
              <li>
                Lake formation: Mendenhall Lake began forming in the early 1900s
                as the glacier pulled back. Multiple sources note a benchmark around
                1929 when the lake was created/exposed.
              </li>
              <li>
                Measured retreat: mapped terminus positions show roughly 5,513 meters
                (18,087 feet / 3.4 miles) of centerline retreat over 261 years
                (1760 to 2021), with the fastest retreat rates in 2007 to 2011
                when the terminus interacted with deeper lake water and calving
                accelerated.
              </li>
              <li>
                Recent milestone: in November 2025, researchers reported the glacier
                was no longer functionally touching Mendenhall Lake, marking a new
                phase of retreat.
              </li>
            </ul>
          </article>
          <article class="info-block">
            <h3>Fun Facts</h3>
            <ul>
              <li>
                It shapes Juneau's watershed: the glacier feeds Mendenhall Lake and
                the Mendenhall River, influencing water levels and seasonal flow.
              </li>
              <li>
                Ice caves exist but are unstable and change year to year. Public
                safety warnings are common because roofs thin and can collapse.
              </li>
              <li>
                It is one of Alaska's most visited easy-access glacier destinations.
                A Bureau of Land Management release cites about 700,000 visitors
                annually, and the Forest Service notes the 1962 visitor center
                historically hosted 400,000+ people per year.
              </li>
            </ul>
          </article>
          <article class="info-block">
            <h3>Why It Matters</h3>
            <p>
              Mendenhall is a visible, local climate signal. NASA notes retreat after
              the Little Ice Age maximum, with especially steep decline in recent
              decades tied to regional warming trends. The glacier's retreat changes
              what visitors can see and access, and researchers expect it may retreat
              out of view from the visitor center's classic vantage point around
              2050.
            </p>
            <p>
              There are real community impacts, too: since 2011, Juneau has faced
              increasing risk from glacial outburst flooding tied to changes in
              glacier geometry and the formation of an ice-dammed basin (Suicide
              Basin). The shifting terminus and calving face also create direct
              safety hazards near the lake edge.
            </p>
          </article>
        </div>
      </div>
    </section>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
